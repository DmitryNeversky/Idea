<mat-card>
    <mat-card-content>
        <h1>Редактирование идеи</h1>
        <form [formGroup]="mainForm" (ngSubmit)="update()">
            <mat-form-field appearance="fill">
                <mat-label>Заголовок</mat-label>
                <input matInput [value]="idea.title" formControlName="title">
                <mat-error *ngIf="mainForm.get('title').hasError('required')">заполните поле</mat-error>
                <mat-error *ngIf="mainForm.get('title').hasError('minlength')">
                    минимальная длина {{mainForm.get('title').errors.minlength.requiredLength}} символов
                    (сейчас {{mainForm.get('title').errors.minlength.actualLength}})
                </mat-error>
                <mat-error *ngIf="mainForm.get('title').hasError('maxlength')">
                    максимальная длина {{mainForm.get('title').errors.maxlength.requiredLength}} символов
                    (сейчас {{mainForm.get('title').errors.maxlength.actualLength}})
                </mat-error>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Основная идея</mat-label>
                <textarea matInput [value]="idea.text" formControlName="text"></textarea>
                <mat-error *ngIf="mainForm.get('text').hasError('required')">заполните поле</mat-error>
                <mat-error *ngIf="mainForm.get('text').hasError('minlength')">
                    минимальная длина {{mainForm.get('text').errors.minlength.requiredLength}} символов
                    (сейчас {{mainForm.get('text').errors.minlength.actualLength}})
                </mat-error>
                <mat-error *ngIf="mainForm.get('text').hasError('maxlength')">
                    максимальная длина {{mainForm.get('text').errors.maxlength.requiredLength}} символов
                    (сейчас {{mainForm.get('text').errors.maxlength.actualLength}})
                </mat-error>
            </mat-form-field>
            <app-chips [tags]="idea.tags" (tagsEmitter)="setTags($event)" #chips></app-chips>
            <div fxLayout="row wrap">
                <img fxFlex.xs="24%" fxFlex.lt-lg="19%" fxFlex.lg="9%" fxFlex.gt-lg="9%" src="{{ image }}" *ngFor="let image of imagesLoader.loadImages" class="image mat-elevation-z2"
                     (click)="imagesLoader.removeImage($event)" alt="load.image">
                <img fxFlex.xs="24%" fxFlex.lt-lg="19%" fxFlex.lg="9%" fxFlex.gt-lg="9%" src="{{ uploadPath + image }}" *ngFor="let image of idea.images" class="image mat-elevation-z2"
                     (click)="imagesLoader.remImage($event, image)" alt="load.image">
            </div>
            <div fxLayout="row wrap" fxLayoutGap="5%">
                <div fxFlex="15%" class="files" *ngFor="let file of idea.files | keyvalue" (click)="filesLoader.remFile($event, file.key)">
                    <img [src]="'assets/images/' + (file.value | imagevar)" alt="image">
                    <p>{{file.value | filename}}</p>
                </div>
                <div fxFlex="15%" class="files" *ngFor="let file of filesLoader.files; let index = index" (click)="filesLoader.removeFile(file, index)">
                    <img [src]="'assets/' + file.icon" alt="images.image">
                    <p>{{file.name}}</p>
                </div>
            </div>
            <div class="form-actions">
                <div class="action">
                    <input type="file" style="display: none" (change)="imagesLoader.load($event)" accept="image/*" multiple #addImage>
                    <input type="file" style="display: none" (change)="filesLoader.loadFiles($event)"
                           accept=".xlsx,.xls,.doc, .docx,.ppt, .pptx,.txt,.pdf,.xml" multiple #addFile>
                    <button type="button" mat-icon-button (click)="addImage.click()">
                        <mat-icon color="warn">add_photo_alternate</mat-icon>
                    </button>
                    <button type="button" mat-icon-button (click)="addFile.click()">
                        <mat-icon color="warn">description</mat-icon>
                    </button>
                </div>
                <div class="action">
                    <button type="submit" (click)="chips.emitChips()" mat-button color="primary">готово</button>
                </div>
            </div>
        </form>
    </mat-card-content>
</mat-card>